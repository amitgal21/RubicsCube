<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulated Drag and Drop</title>
    <style>
        #drag-element {
            width: 100px;
            height: 100px;
            background-color: lightblue;
            position: absolute;
            cursor: grabbing;
        }
        body {
            user-select: none; /* Prevent text selection while dragging */
        }
    </style>
</head>
<body>

    <div id="drag-element">Drag me</div>

    <script>
        // Function to simulate mouse events
        function simulateMouseEvent(type, clientX, clientY) {
            const event = new MouseEvent(type, {
                bubbles: true,
                cancelable: true,
                clientX: clientX,
                clientY: clientY,
                button: 0, // Left mouse button
            });
            document.getElementById('drag-element').dispatchEvent(event);
        }

        // Function to simulate mouse drag (move + click)
        function simulateMouseDrag(fromX, fromY, toX, toY, duration) {
            const dragElement = document.getElementById('drag-element');

            // Block the user's mouse during the dragging
            document.body.style.pointerEvents = 'none';

            // Set the initial position of the element
            dragElement.style.left = `${fromX}px`;
            dragElement.style.top = `${fromY}px`;

            // Simulate mousedown
            simulateMouseEvent('mousedown', fromX, fromY);

            // Move the mouse gradually (simulate dragging)
            const startTime = Date.now();

            function moveMouse() {
                const elapsed = Date.now() - startTime;
                const progress = Math.min(elapsed / duration, 1); // Ensure the progress does not exceed 1

                // Calculate intermediate position
                const currentX = fromX + (toX - fromX) * progress;
                const currentY = fromY + (toY - fromY) * progress;

                // Update the position of the drag element
                dragElement.style.left = `${currentX}px`;
                dragElement.style.top = `${currentY}px`;

                // Simulate mousemove
                simulateMouseEvent('mousemove', currentX, currentY);

                if (progress < 1) {
                    requestAnimationFrame(moveMouse); // Continue moving until the duration is reached
                } else {
                    // Simulate mouseup after the move is complete
                    simulateMouseEvent('mouseup', currentX, currentY);

                    // Unblock the user's mouse after dragging is complete
                    document.body.style.pointerEvents = 'auto';
                }
            }

            moveMouse();
        }

        // Expose the simulateMouseDrag function to be callable from other scripts
        window.simulateMouseDrag = simulateMouseDrag;

        // Call simulateMouseDrag from another script (this example simulates a drag after 2 seconds)
        setTimeout(function() {
            window.simulateMouseDrag(100, 100, 500, 500, 2000); // Drag from (100, 100) to (500, 500) in 2 seconds
        }, 2000); // Trigger the drag after 2 seconds
    </script>

</body>
</html>
